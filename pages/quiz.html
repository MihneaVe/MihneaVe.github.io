<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smarthack Quiz</title>
    <!-- Google Fonts: Inter (body) and Poppins (headings) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ========== VARIABLE DEFINITIONS ========== */
      :root {
        /* Color palette */
        --accent-dark: #0284c7;
        --primary-dark: #6e11b0;
        --background: #1a0d2f;
        --card-bg: #2e0f4d;
        --primary: #8c52ff; /* Purple */
        --accent: #00bcff; /* Blue */
        --accent-light: rgba(140, 82, 255, 0.1);
        --text: #f8fafc;
        --text-secondary: #94a3b8;
        --border: #334155;
        --success: #10b981;
        --error: #ef4444;
        /* Shadow effect */
        --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      /* ========== BASE STYLES ========== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        line-height: 1.6;
        /* Background with circuit pattern and radial gradients */
        background-color: var(--background);
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400' viewBox='0 0 800 800'%3E%3Cg fill='none' stroke='%2300ffff' stroke-width='1'%3E%3Cpath d='M769 229L1037 260.9M927 880L731 737 520 660 309 538 40 599 295 764 126.5 879.5 40 599-197 493 102 382-31 229 126.5 79.5-69-63'/%3E%3Cpath d='M-31 229L237 261 390 382 603 493 308.5 537.5 101.5 381.5M370 905L295 764'/%3E%3Cpath d='M520 660L578 842 731 737 840 599 603 493 520 660 295 764 309 538 390 382 539 269 769 229 577.5 41.5 370 105 295 -36 126.5 79.5 237 261 102 382 40 599 -69 737 127 880'/%3E%3Cpath d='M520-140L578.5 42.5 731-63M603 493L539 269 237 261 370 105M902 382L539 269M390 382L102 382'/%3E%3Cpath d='M-222 42L126.5 79.5 370 105 539 269 577.5 41.5 927 80 769 229 902 382 603 493 731 737M295-36L577.5 41.5M578 842L295 764M40-201L127 80M102 382L-261 269'/%3E%3C/g%3E%3Cg fill='%2300ffff'%3E%3Ccircle cx='769' cy='229' r='5'/%3E%3Ccircle cx='539' cy='269' r='5'/%3E%3Ccircle cx='603' cy='493' r='5'/%3E%3Ccircle cx='731' cy='737' r='5'/%3E%3Ccircle cx='520' cy='660' r='5'/%3E%3Ccircle cx='309' cy='538' r='5'/%3E%3Ccircle cx='295' cy='764' r='5'/%3E%3Ccircle cx='40' cy='599' r='5'/%3E%3Ccircle cx='102' cy='382' r='5'/%3E%3Ccircle cx='127' cy='80' r='5'/%3E%3Ccircle cx='370' cy='105' r='5'/%3E%3Ccircle cx='578' cy='42' r='5'/%3E%3Ccircle cx='237' cy='261' r='5'/%3E%3Ccircle cx='390' cy='382' r='5'/%3E%3C/g%3E%3C/svg%3E"),
          radial-gradient(
            circle at 20% 30%,
            rgba(140, 82, 255, 0.15) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 70%,
            rgba(0, 188, 255, 0.1) 0%,
            transparent 50%
          );
        background-attachment: fixed;
        color: var(--text);
        padding: 20px;
        position: relative;
        overflow-x: hidden;
      }

      /* ========== LAYOUT COMPONENTS ========== */
      .container {
        max-width: 800px;
        margin: 0 auto;
        background-color: rgba(30, 41, 59, 0.65);
        backdrop-filter: blur(10px); /* Creates glass effect */
        border-radius: 16px;
        box-shadow: var(--shadow);
        padding: 40px;
        border: 1px solid var(--border);
      }

      /* ========== HEADER STYLES ========== */
      header {
        text-align: center;
        margin-bottom: 40px;
      }

      /* Heading with glitch effect */
      h1 {
        font-family: "Poppins", sans-serif;
        font-size: 2.5rem;
        font-weight: 700;
        color: white;
        position: relative;
        overflow: visible;
      }

      /* Glitch effect - creates RGB shift animations */
      h1::before,
      h1::after {
        content: attr(data-text);
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        overflow: hidden;
        z-index: -1;
      }

      h1::before {
        color: cyan;
        animation: reverse-position 0.25s infinite linear;
      }

      h1::after {
        color: magenta;
        animation: forward-position 0.2s infinite linear;
      }

      @keyframes reverse-position {
        0% {
          left: 0;
          top: 0;
        }
        50% {
          left: -2px;
          top: -2px;
        }
        100% {
          left: 0;
          top: 0;
        }
      }

      @keyframes forward-position {
        0% {
          left: 0;
          top: 0;
        }
        50% {
          left: 2px;
          top: 2px;
        }
        100% {
          left: 0;
          top: 0;
        }
      }

      header p {
        color: var(--text-secondary);
        font-size: 1.1rem;
        font-weight: 400;
      }

      /* ========== CONTENT COMPONENTS ========== */
      /* Instructions box */
      .instructions {
        margin-bottom: 40px;
        padding: 20px;
        background-color: rgba(56, 189, 248, 0.05);
        border-left: 4px solid var(--accent);
        border-radius: 6px;
      }

      .quiz-form {
        margin-top: 30px;
      }

      /* Question card styling */
      .question-container {
        margin-bottom: 30px;
        padding: 25px;
        background-color: rgba(30, 41, 59, 0.8);
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        position: relative;
        transition: all 0.3s ease;
      }

      .question-container:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      }

      /* Question text styling */
      .question {
        font-family: "Poppins", sans-serif;
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 20px;
        color: var(--text);
        border-bottom: 1px solid var(--border);
        padding-bottom: 12px;
      }

      .question span {
        color: var(--accent);
        font-weight: 700;
      }

      /* Answer options container */
      .options {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      /* Individual answer option styling */
      .option {
        display: flex;
        align-items: center;
        padding: 0;
        border-radius: 8px;
        transition: all 0.2s ease;
        background-color: rgba(51, 65, 85, 0.5);
        border: 1px solid transparent;
        cursor: pointer;
      }

      .option:hover {
        background-color: rgba(56, 189, 248, 0.1);
        border-color: var(--accent);
      }

      /* Make entire label area clickable */
      .option label {
        cursor: pointer;
        flex-grow: 1;
        font-weight: 500;
        padding: 16px;
        display: flex;
        align-items: center;
        width: 100%;
      }

      /* Custom radio button styling */
      .option input {
        margin-right: 15px;
        cursor: pointer;
        appearance: none;
        width: 22px;
        height: 22px;
        border: 2px solid var(--accent);
        border-radius: 50%;
        position: relative;
        transition: all 0.2s ease;
        flex-shrink: 0;
      }

      .option input:checked {
        border-color: var(--accent);
        background-color: rgba(56, 189, 248, 0.2);
      }

      /* Create dot inside checked radio */
      .option input:checked::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: var(--accent);
      }

      /* ========== BUTTON CONTROLS ========== */
      .controls {
        display: flex;
        justify-content: space-between;
        margin-top: 50px;
      }

      /* Base button styles */
      .btn {
        padding: 14px 32px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-family: "Inter", sans-serif;
        font-size: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      /* Primary (blue) button */
      .btn-primary {
        background-color: var(--accent);
        color: var(--background);
        box-shadow: 0 4px 14px rgba(56, 189, 248, 0.4);
      }

      .btn-primary:hover {
        background-color: var(--accent-dark);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(56, 189, 248, 0.5);
      }

      /* Navigation button (purple) */
      #prev-btn {
        background-color: var(--primary);
        color: var(--background);
        border: none;
        outline: none;
        box-shadow: 0 4px 14px rgba(140, 82, 255, 0.4);
      }

      #prev-btn:hover {
        background-color: rgba(140, 82, 255, 0.7);
        transform: translateY(-2px);
        border: none;
        outline: none;
        box-shadow: 0 6px 20px rgba(140, 82, 255, 0.5);
      }

      /* Secondary (outline) button */
      .btn-secondary {
        background-color: transparent;
        color: var(--text-secondary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover {
        background-color: rgba(148, 163, 184, 0.1);
        color: var(--text);
        border-color: var(--text-secondary);
        transform: translateY(-2px);
      }

      /* Results container */
      #results {
        background-color: rgba(30, 41, 59, 0.8);
        padding: 25px;
        margin-top: 40px;
        border-radius: 12px;
        border-left: 4px solid var(--accent);
        box-shadow: var(--shadow);
      }

      /* Disabled button states */
      #next-btn:disabled {
        background-color: #6b7280;
        opacity: 0.6;
      }

      #submit-btn:disabled {
        background-color: #6b7280;
        cursor: not-allowed;
        opacity: 0.6;
      }

      /* ========== RESPONSIVE DESIGN ========== */
      @media (max-width: 768px) {
        .container {
          padding: 30px 20px;
          margin: 10px;
        }

        h1 {
          font-size: 1.8rem;
        }

        .question-container {
          padding: 20px;
        }

        .btn {
          padding: 12px 24px;
          font-size: 0.95rem;
        }
      }

      /* ========== PROGRESS INDICATOR ========== */
      .progress-container {
        width: 100%;
        margin-bottom: 30px;
      }

      .progress-bar {
        height: 6px;
        background: var(--border);
        border-radius: 3px;
        position: relative;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--accent));
        border-radius: 3px;
        width: 0%;
        transition: width 0.5s ease;
      }

      .progress-text {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
        font-size: 0.9rem;
        color: var(--text-secondary);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- ========== HEADER SECTION ========== -->
      <header>
        <h1 data-text="Smarthack Quiz">Smarthack Quiz</h1>
        <p>Challenge yourself with randomized programming questions</p>
      </header>

      <!-- ========== INSTRUCTIONS SECTION ========== -->
      <div class="instructions">
        <p>
          Select the correct answer for each question. Questions are randomized
          each time you take the quiz.
        </p>
      </div>

      <!-- ========== PROGRESS TRACKING ========== -->
      <div class="progress-container">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="progress-text">
          <span>0% complete</span>
          <span id="question-counter">0/10 questions</span>
        </div>
      </div>

      <!-- ========== QUIZ FORM ========== -->
      <form class="quiz-form" id="quiz-form">
        <!-- Dynamic questions will be inserted here -->
        <div id="questions-container">
          <!-- Question containers will be inserted here dynamically -->
        </div>

        <!-- ========== NAVIGATION BUTTONS ========== -->
        <div
          class="navigation-buttons"
          style="
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
          "
        >
          <button type="button" id="prev-btn" class="btn btn-secondary">
            Previous
          </button>
          <button type="button" id="next-btn" class="btn btn-primary">
            Next
          </button>
        </div>

        <!-- ========== CONTROL BUTTONS ========== -->
        <div class="controls">
          <button type="button" class="btn btn-secondary" id="clear-btn">
            Reset Quiz
          </button>
          <button
            type="submit"
            class="btn btn-primary"
            id="submit-btn"
            disabled
          >
            Submit Answers
          </button>
        </div>
      </form>

      <!-- ========== RESULTS CONTAINER ========== -->
      <div id="results" style="display: none">
        <!-- Results will be displayed here -->
      </div>

      <!-- ========== ORGANIZER LOGOS ========== -->
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-top: 40px;
          padding-top: 30px;
          border-top: 1px solid rgba(255, 255, 255, 0.1);
        "
      >
        <!-- ASMI Logo -->
        <img
          src="../assets/img/ASMI_alb.png"
          alt="ASMI Logo"
          style="
            max-width: 120px;
            height: auto;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.3));
          "
        />

        <!-- Smarthack Logo -->
        <img
          src="../assets/img/Smarthack.png"
          alt="Smarthack Logo"
          style="
            max-width: 120px;
            height: auto;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.3));
          "
        />
      </div>
    </div>

    <script>
      /**
       * ========== QUIZ DATA ==========
       * Question templates with predefined answers
       * Each question has one correct answer marked with [CORRECT]
       */
      const questionTemplates = [
        {
          id: 1,
          text: "Question about HTML: What does HTML stand for?",
          options: [
            "Hyper Text Markup Language [CORRECT]",
            "High Tech Machine Learning",
            "Hyperlink and Text Markup Language",
            "Hyper Transfer Markup Language",
          ],
        },
        {
          id: 2,
          text: "Question about CSS: Which property changes the text color?",
          options: [
            "font-style",
            "color [CORRECT]",
            "text-style",
            "font-color",
          ],
        },
        {
          id: 3,
          text: "Question about JavaScript: Which method adds an element to the end of an array?",
          options: ["append()", "add()", "push() [CORRECT]", "insert()"],
        },
        {
          id: 4,
          text: "Question about databases: SQL stands for:",
          options: [
            "Structured Query Language [CORRECT]",
            "Simple Query Language",
            "Sequential Query Language",
            "Standard Question Language",
          ],
        },
        {
          id: 5,
          text: "Question about networking: Which protocol is used for secure web browsing?",
          options: ["FTP", "HTTP", "SMTP", "HTTPS [CORRECT]"],
        },
        {
          id: 6,
          text: "Question about programming: What is the correct way to declare a variable in Python?",
          options: [
            "var x = 5;",
            "let x = 5;",
            "x = 5 [CORRECT]",
            "int x = 5;",
          ],
        },
        {
          id: 7,
          text: "Question about data structures: Which data structure follows LIFO?",
          options: ["Queue", "Stack [CORRECT]", "Linked List", "Array"],
        },
        {
          id: 8,
          text: "Question about algorithms: What is the time complexity of binary search?",
          options: ["O(n)", "O(n²)", "O(log n) [CORRECT]", "O(n log n)"],
        },
        {
          id: 9,
          text: "Question about operating systems: Which is not an operating system?",
          options: ["Oracle [CORRECT]", "Windows", "Linux", "macOS"],
        },
        {
          id: 10,
          text: "Question about cloud computing: Which service model provides virtualized computing resources?",
          options: ["SaaS", "IaaS [CORRECT]", "PaaS", "DaaS"],
        },
        {
          id: 11,
          text: "What is the correct HTML tag for the largest heading?",
          options: ["h6", "heading", "h1 [CORRECT]", "head"],
        },
        {
          id: 12,
          text: "In JavaScript, which array method creates a new array with the results of calling a function for every array element?",
          options: ["forEach()", "map() [CORRECT]", "filter()", "reduce()"],
        },
        {
          id: 13,
          text: "Which CSS property is used to create space between element's border and its content?",
          options: ["margin", "spacing", "padding [CORRECT]", "border-spacing"],
        },
        {
          id: 14,
          text: "What does the 'async' keyword do in JavaScript?",
          options: [
            "Makes a function run in a separate thread",
            "Ensures functions execute in sequence",
            "Allows the use of await in a function [CORRECT]",
            "Automatically catches errors in promises",
          ],
        },
        {
          id: 15,
          text: "Which design pattern provides a simplified interface to a complex system of classes?",
          options: ["Factory", "Facade [CORRECT]", "Decorator", "Singleton"],
        },
        {
          id: 16,
          text: "What is the time complexity of inserting an element into a balanced binary search tree?",
          options: ["O(1)", "O(n)", "O(log n) [CORRECT]", "O(n²)"],
        },
      ];

      /**
       * ========== UTILITY FUNCTIONS ==========
       */

      /**
       * Fisher-Yates shuffle algorithm
       * Randomizes array elements in-place
       * @param {Array} array - The array to shuffle
       * @return {Array} - The shuffled array (same reference)
       */
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      /**
       * ========== QUIZ GENERATION ==========
       */

      /**
       * Generates a randomized quiz with shuffled questions and options
       * Creates HTML elements for each question and inserts them into the DOM
       */
      function generateRandomQuiz() {
        const questionsContainer = document.getElementById(
          "questions-container"
        );
        questionsContainer.innerHTML = "";

        // Shuffle all available questions
        const shuffledQuestions = shuffleArray([...questionTemplates]);

        // Take only the first 10 questions from the shuffled array
        const selectedQuestions = shuffledQuestions.slice(0, 10);

        selectedQuestions.forEach((question, index) => {
          // Create a copy of options to shuffle
          const options = [...question.options];

          // Find the correct answer before shuffling
          const correctIndex = options.findIndex((option) =>
            option.includes("[CORRECT]")
          );
          const correctAnswer = options[correctIndex].replace(" [CORRECT]", "");

          // Remove the [CORRECT] marker for display
          options[correctIndex] = correctAnswer;

          // Shuffle the options
          const shuffledOptions = shuffleArray([...options]);

          // Find where the correct answer is now after shuffling
          const newCorrectIndex = shuffledOptions.findIndex(
            (option) => option === correctAnswer
          );

          // Create the question container with formatted number (01, 02, etc.)
          const questionNumber = index + 1;
          const formattedNumber =
            questionNumber < 10 ? `0${questionNumber}` : `${questionNumber}`;

          // Generate HTML for this question
          const questionHTML = `
            <div class="question-container" data-correct="${
              newCorrectIndex + 1
            }">
              <div class="question" id="question-${questionNumber}">
                <span>${formattedNumber}.</span> ${question.text}
              </div>
              <div class="options">
                ${shuffledOptions
                  .map(
                    (option, i) => `
                  <div class="option">
                    <label for="q${questionNumber}-option${i + 1}">
                      <input
                        type="radio"
                        name="q${questionNumber}"
                        id="q${questionNumber}-option${i + 1}"
                        value="${i + 1}"
                      />
                      <span>${option}</span>
                    </label>
                  </div>
                `
                  )
                  .join("")}
              </div>
            </div>
          `;

          // Add the question to the container
          questionsContainer.innerHTML += questionHTML;

          // Add event listeners to update button state when option selected
          setTimeout(() => {
            document
              .querySelectorAll(`input[name="q${questionNumber}"]`)
              .forEach((input) => {
                input.addEventListener("change", updateNextButtonState);
              });
          }, 0);

          // Initialize with only the first question visible
          let currentQuestionIndex = 0;
          const questionElements = document.querySelectorAll(
            ".question-container"
          );

          questionElements.forEach((el, index) => {
            el.style.display = index === 0 ? "block" : "none";
          });

          // Update navigation buttons initial state
          updateNavigationButtons();
        });

        // Add event listeners to all radio buttons for progress tracking
        document.querySelectorAll('input[type="radio"]').forEach((radio) => {
          radio.addEventListener("change", updateProgress);
        });
      }

      /**
       * ========== QUESTION NAVIGATION ==========
       */

      // Track current question index
      let currentQuestionIndex = 0;

      /**
       * Displays a specific question and hides others
       * @param {number} index - The index of the question to show
       */
      function showQuestion(index) {
        const questions = document.querySelectorAll(".question-container");

        // Show only the current question
        questions.forEach((q, i) => {
          q.style.display = i === index ? "block" : "none";
        });

        // Update global index and UI states
        currentQuestionIndex = index;
        updateNavigationButtons();
        updateNextButtonState();
      }

      /**
       * Updates the enabled/disabled state of the Next button
       * based on whether the current question has been answered
       */
      function updateNextButtonState() {
        const question = document.querySelectorAll(".question-container")[
          currentQuestionIndex
        ];
        const selected = question.querySelector('input[type="radio"]:checked');
        const nextBtn = document.getElementById("next-btn");

        // Enable Next button only if an option is selected
        document.getElementById("next-btn").disabled = !selected;

        const submitBtn = document.getElementById("submit-btn");
        const totalQuestions = document.querySelectorAll(
          ".question-container"
        ).length;

        // Control button visibility based on question position
        if (currentQuestionIndex < totalQuestions - 1) {
          nextBtn.disabled = !selected;
          submitBtn.disabled = true;
        }

        // Show submit button only on last question
        if (currentQuestionIndex === totalQuestions - 1) {
          submitBtn.disabled = !selected;
        } else {
          nextBtn.style.display = "inline-block";
        }
      }

      /**
       * Updates navigation button visibility based on current question position
       */
      function updateNavigationButtons() {
        const totalQuestions = document.querySelectorAll(
          ".question-container"
        ).length;

        // Hide Previous button on first question
        document.getElementById("prev-btn").style.visibility =
          currentQuestionIndex > 0 ? "visible" : "hidden";

        // Hide Next button on last question
        document.getElementById("next-btn").style.display =
          currentQuestionIndex < totalQuestions - 1 ? "inline-block" : "none";

        // Show Submit button only on last question
        const submitBtn = document.querySelector(
          '#quiz-form button[type="submit"]'
        );
        if (currentQuestionIndex === totalQuestions - 1) {
          submitBtn.style.display = "inline-block";
        } else {
          submitBtn.style.display = "none";
        }

        // Position the Reset button correctly based on current question
        const retakeBtn = document.getElementById("clear-btn");
        if (currentQuestionIndex === totalQuestions - 1) {
          retakeBtn.style.marginLeft = "";
          retakeBtn.style.marginRight = "";
        } else {
          retakeBtn.style.margin = "0 auto";
          retakeBtn.style.display = "block";
        }
      }

      /**
       * ========== EVENT HANDLERS ==========
       */

      // Previous button handler
      document
        .getElementById("prev-btn")
        .addEventListener("click", function () {
          if (currentQuestionIndex > 0) {
            showQuestion(currentQuestionIndex - 1);
          }
        });

      // Next button handler
      document
        .getElementById("next-btn")
        .addEventListener("click", function () {
          const totalQuestions = document.querySelectorAll(
            ".question-container"
          ).length;
          if (currentQuestionIndex < totalQuestions - 1) {
            showQuestion(currentQuestionIndex + 1);
          }
        });

      // Initialize quiz on page load
      document.addEventListener("DOMContentLoaded", function () {
        generateRandomQuiz();
        showQuestion(0);
      });

      /**
       * Updates the progress bar based on number of questions answered
       * Called whenever a radio button selection changes
       */
      function updateProgress() {
        const totalQuestions = 10;
        let answeredQuestions = 0;

        // Count answered questions
        for (let i = 1; i <= totalQuestions; i++) {
          const radioButtons = document.querySelectorAll(`input[name="q${i}"]`);
          let isAnswered = false;
          radioButtons.forEach((button) => {
            if (button.checked) {
              isAnswered = true;
            }
          });

          if (isAnswered) {
            answeredQuestions++;
          }
        }

        // Update progress UI elements
        const percentage = Math.floor(
          (answeredQuestions / totalQuestions) * 100
        );
        document.getElementById("progress-fill").style.width = `${percentage}%`;
        document.querySelector(
          ".progress-text span"
        ).textContent = `${percentage}% complete`;
        document.getElementById(
          "question-counter"
        ).textContent = `${answeredQuestions}/${totalQuestions} questions`;
      }

      // Reset quiz button handler
      document
        .getElementById("clear-btn")
        .addEventListener("click", function () {
          location.reload();
        });

      /**
       * ========== FORM SUBMISSION AND EMAIL COLLECTION ==========
       */
      document
        .getElementById("quiz-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          // Validate all questions are answered and count correct answers
          let allAnswered = true;
          let correctAnswers = 0;

          const questions = document.querySelectorAll(".question-container");
          questions.forEach((question, index) => {
            const questionNumber = index + 1;
            const options = question.querySelectorAll(".option input");
            let answered = false;
            let selectedAnswer = 0;

            // Check if question is answered and which option was selected
            options.forEach((option) => {
              if (option.checked) {
                answered = true;
                selectedAnswer = parseInt(option.value);
              }
            });

            // Visual feedback for unanswered questions
            if (!answered) {
              allAnswered = false;
              question.style.border = "1px solid var(--error)";
              question.style.boxShadow = "0 0 15px rgba(239, 68, 68, 0.3)";
            } else {
              question.style.border = "1px solid var(--border)";
              question.style.boxShadow = "0 4px 6px rgba(0, 0, 0, 0.1)";

              // Check if the answer is correct
              const correctAnswer = parseInt(question.dataset.correct);
              if (selectedAnswer === correctAnswer) {
                correctAnswers++;
              }
            }
          });

          // If not all questions are answered, show alert and stop
          if (!allAnswered) {
            alert("Please answer all questions before submitting.");
            return;
          }

          // Hide quiz form and show email collection form
          document.getElementById("quiz-form").style.display = "none";
          document.querySelector(".instructions").style.display = "none";
          document.querySelector(".progress-container").style.display = "none";

          // Show email collection form
          document.getElementById("results").style.display = "block";
          document.getElementById("results").innerHTML = `
    <div style="text-align: center; padding: 30px 0;">
      <h2 style="font-size: 2rem; margin-bottom: 20px; color: var(--accent);">Enter Your Email to See Results</h2>
      <p style="margin-bottom: 25px; color: var(--text-secondary);">Please provide your email address to view your quiz score.</p>
      
      <form id="email-form" action="https://formspree.io/f/xrbyljek" method="POST" style="max-width: 400px; margin: 0 auto;">
        <input type="hidden" name="quiz_score" value="${correctAnswers}/10" />
        <input type="hidden" name="_cc" id="cc-email" />
        <input type="hidden" name="_subject" value="Your Smarthack Quiz Results" />
        <input type="hidden" name="_next" value="https://mihneave.github.io/pages/quiz-success.html?score=${correctAnswers}" />
        <div style="margin-bottom: 20px;">
          <input 
            type="email" 
            name="email"
            id="user-email" 
            placeholder="your.email@example.com" 
            required
            style="width: 100%; padding: 12px 15px; border-radius: 8px; background-color: rgba(51, 65, 85, 0.5); border: 1px solid var(--border); color: var(--text); font-size: 1rem;"
          />
        </div>
        <button type="submit" class="btn btn-primary" style="width: 100%;">See My Score</button>
      </form>
    </div>
  `;

          // Copy email to CC field on form submission
          document
            .getElementById("email-form")
            .addEventListener("submit", function (e) {
              const email = document.getElementById("user-email").value.trim();
              document.getElementById("cc-email").value = email;
            });

          /**
           * Handle email form submission with AJAX
           * Sends data to Formspree and displays results
           */
          document
            .getElementById("email-form")
            .addEventListener("submit", function (e) {
              e.preventDefault();
              const emailInput = document.getElementById("user-email");
              const email = emailInput.value.trim();
              const score = correctAnswers;

              // Validate email format
              const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
              if (!emailRegex.test(email)) {
                alert("Please enter a valid email address");
                return;
              }

              // Prepare data for submission
              const formData = new FormData();
              formData.append("email", email);
              formData.append("quiz_score", score + "/10");
              formData.append("_cc", email); // Send copy to user
              formData.append("_subject", "Your Smarthack Quiz Results");

              // Submit to Formspree
              fetch("https://formspree.io/f/xyzdbjvl", {
                method: "POST",
                body: formData,
                headers: {
                  Accept: "application/json",
                },
              })
                .then((response) => {
                  if (response.ok) {
                    // Show results after successful submission
                    document.getElementById("results").innerHTML = `
        <div style="text-align: center; padding: 30px 0;">
          <h2 style="font-size: 2.5rem; margin-bottom: 20px; color: var(--accent);">Your Score</h2>
          <div style="font-size: 4rem; font-weight: 700; color: var(--text); margin-bottom: 10px;">
            ${score}/10
          </div>
          <div style="font-size: 1.5rem; color: var(--text-secondary);">
            ${score * 10}%
          </div>
          <p style="margin-top: 15px; font-size: 0.9rem; color: var(--text-secondary);">
            Results sent to: ${email}
          </p>
          <button id="retake-btn" class="btn btn-primary" style="margin-top: 30px;">
            Retake Quiz
          </button>
        </div>
      `;

                    // Add retake button functionality
                    document
                      .getElementById("retake-btn")
                      .addEventListener("click", function () {
                        location.reload();
                      });
                  } else {
                    // Handle submission error
                    alert(
                      "There was a problem submitting your form. Please try again."
                    );
                  }
                })
                .catch((error) => {
                  console.error("Error:", error);
                  alert(
                    "There was a problem submitting your form. Please try again."
                  );
                });
            });

          // Scroll to top for email form
          window.scrollTo(0, 0);
        });
    </script>
  </body>
</html>
